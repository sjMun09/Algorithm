```java
import java.io.*;
import java.util.*;

public class Main {
    static long solve(int n, long x1, long x2, long y) {
        return hilbert(n, 0, 0, 1L << n, x1, x2, y);
    }

    static long hilbert(int n, long ox, long oy, long size, long x1, long x2, long y) {
        if (n == 0) return 0;

        long half = size >> 1;
        long cnt = 0;

        cnt += hilbert(n - 1, ox, oy, half, x1, x2, y);

        if (y >= oy + half)
            cnt += hilbert(n - 1, ox, oy + half, half, x1, x2, y);

        if (y >= oy + half)
            cnt += hilbert(n - 1, ox + half, oy + half, half, x1, x2, y);

        cnt += hilbert(n - 1, ox + half, oy, half, x1, x2, y);

        if (y == oy + half && x1 <= ox && ox < x2) cnt++;
        if (y >= oy + half && y < oy + size && x1 <= ox + half && ox + half < x2) cnt++;
        if (y == oy + half && x1 <= ox + size && ox + size < x2) cnt++;

        return cnt;
    }

    public static void main(String[] args) throws IOException {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        String line;
        StringBuilder sb = new StringBuilder();

        while ((line = br.readLine()) != null) {
            if (line.equals("0")) break;
            StringTokenizer st = new StringTokenizer(line);
            int n = Integer.parseInt(st.nextToken());
            long x1 = Long.parseLong(st.nextToken());
            long x2 = Long.parseLong(st.nextToken());
            long y = Long.parseLong(st.nextToken());

            long ans = solve(n, x1, x2, y);
            sb.append(ans).append("\n");
        }
        System.out.print(sb);
    }
}

```
